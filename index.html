<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quote.Web — Curator Dashboard</title>
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Fraunces:opsz,wght@9..144,300;400;500;600&family=Manrope:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <style>
        :root {
            /* Palette - Deep Void Theme */
            --bg-void: #050505;
            --bg-panel: #0e0e0e;
            --bg-glass: rgba(20, 20, 20, 0.6);
            --border-dim: rgba(255, 255, 255, 0.08);
            --border-highlight: rgba(255, 255, 255, 0.15);
            
            --text-main: #f3f4f6;
            --text-muted: #a1a1aa;
            --text-faint: #52525b;
            
            --accent-primary: #8b5cf6;
            --accent-glow: rgba(139, 92, 246, 0.15);
            --accent-coral: #f472b6;
            
            --font-display: 'Fraunces', serif;
            --font-ui: 'Manrope', sans-serif;
            
            --sidebar-width: 260px;
            --sidebar-width-collapsed: 72px;
            --ease-out-expo: cubic-bezier(0.16, 1, 0.3, 1);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            background-color: var(--bg-void);
            color: var(--text-main);
            font-family: var(--font-ui);
            height: 100vh;
            overflow: hidden;
            display: flex;
        }

        ::selection {
            background-color: var(--accent-primary);
            color: white;
        }

        /* Background Animation */
        .bg-canvas {
            position: fixed;
            inset: 0;
            z-index: 0;
            background: transparent;
            pointer-events: none;
        }

        .star-layer {
            position: absolute;
            top: 0;
            left: 0;
            width: 2px;
            height: 2px;
            border-radius: 50%;
            opacity: 0; /* Fade in via JS */
            transition: opacity 1s ease;
            box-shadow: 0 0 white; /* Placeholder */
            animation: drift linear infinite;
            will-change: transform; /* Hint to browser for performance */
        }

        .layer-1 { animation-duration: 120s; }
        .layer-2 { animation-duration: 240s; }
        .layer-3 { animation-duration: 360s; }

        @keyframes drift {
            from { transform: translateY(0); }
            to { transform: translateY(-100vh); }
        }

        /* --- Sidebar --- */
        .sidebar {
            width: var(--sidebar-width-collapsed); /* Collapsed by default on mobile/small */
            border-right: 1px solid var(--border-dim);
            display: flex;
            flex-direction: column;
            padding: 24px 12px;
            background: var(--bg-void);
            z-index: 50;
            transition: width 0.4s var(--ease-out-expo);
        }

        @media (min-width: 768px) {
            .sidebar { width: var(--sidebar-width-collapsed); }
            .sidebar:hover { width: var(--sidebar-width); }
        }

        .brand {
            height: 48px;
            display: flex;
            align-items: center;
            gap: 16px;
            padding-left: 12px;
            margin-bottom: 32px;
            overflow: hidden;
            white-space: nowrap;
        }

        .brand-logo {
            min-width: 24px;
            height: 24px;
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-coral));
            border-radius: 6px;
            box-shadow: 0 0 15px var(--accent-glow);
        }

        .brand-name {
            font-weight: 700;
            letter-spacing: -0.02em;
            font-size: 16px;
            opacity: 0;
            transform: translateX(-10px);
            transition: all 0.3s ease;
        }

        .sidebar:hover .brand-name { opacity: 1; transform: translateX(0); }

        .nav-menu {
            display: flex;
            flex-direction: column;
            gap: 8px;
            flex: 1;
        }

        .nav-item {
            display: flex;
            align-items: center;
            gap: 16px;
            padding: 12px;
            border-radius: 12px;
            color: var(--text-muted);
            cursor: pointer;
            transition: all 0.2s ease;
            white-space: nowrap;
            overflow: hidden;
            text-decoration: none;
        }

        .nav-item:hover, .nav-item.active {
            background: var(--border-dim);
            color: var(--text-main);
        }
        
        .nav-item.active {
            background: var(--accent-glow);
            color: #d8b4fe;
            border: 1px solid rgba(139, 92, 246, 0.1);
        }

        .nav-icon { min-width: 20px; }
        .nav-label { 
            font-size: 14px; 
            font-weight: 500; 
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        .sidebar:hover .nav-label { opacity: 1; }

        .shortcut-hint {
            margin-left: auto;
            font-size: 10px;
            background: var(--border-dim);
            padding: 2px 6px;
            border-radius: 4px;
            color: var(--text-faint);
            opacity: 0;
        }
        .sidebar:hover .shortcut-hint { opacity: 1; }

        /* --- Main Content --- */
        .workspace {
            flex: 1;
            position: relative;
            z-index: 1; /* Place above background */
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 40px;
        }

        /* Toolbar (Top Right) */
        .toolbar {
            position: absolute;
            top: 24px;
            right: 24px;
            display: flex;
            gap: 12px;
        }

        .tool-btn {
            background: transparent;
            border: 1px solid var(--border-dim);
            color: var(--text-muted);
            padding: 10px;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .tool-btn:hover {
            border-color: var(--text-muted);
            color: var(--text-main);
            background: var(--border-dim);
        }

        /* Reader View */
        .reader-container {
            max-width: 800px;
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            animation: fadeIn 0.8s var(--ease-out-expo);
        }

        .quote-badge {
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 0.2em;
            color: var(--accent-primary);
            margin-bottom: 32px;
            font-weight: 600;
            padding: 6px 12px;
            background: rgba(139, 92, 246, 0.05);
            border-radius: full;
            border: 1px solid rgba(139, 92, 246, 0.1);
        }

        .quote-display {
            font-family: var(--font-display);
            font-size: clamp(32px, 5vw, 56px);
            line-height: 1.15;
            letter-spacing: -0.02em;
            color: var(--text-main);
            margin-bottom: 40px;
            font-weight: 400;
            /* Text gradient */
            background: radial-gradient(circle at center, #fff, #a1a1aa);
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            transition: opacity 0.3s ease, transform 0.3s ease;
        }
        
        .quote-display.loading {
            opacity: 0.5;
            filter: blur(4px);
            transform: scale(0.98);
        }

        .author-block {
            display: flex;
            align-items: center;
            gap: 12px;
            color: var(--text-muted);
            font-size: 15px;
            font-weight: 500;
        }

        .author-line {
            width: 32px;
            height: 1px;
            background: var(--border-highlight);
        }

        /* Dock (Bottom Actions) */
        .dock {
            position: absolute;
            bottom: 40px;
            background: var(--bg-glass);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid var(--border-highlight);
            padding: 8px;
            border-radius: 20px;
            display: flex;
            gap: 8px;
            box-shadow: 0 20px 40px -10px rgba(0,0,0,0.5);
            transition: transform 0.2s cubic-bezier(0.2, 0, 0, 1);
        }
        
        .dock:hover { transform: translateY(-4px); }

        .dock-btn {
            border: none;
            background: transparent;
            color: var(--text-main);
            padding: 12px 20px;
            border-radius: 12px;
            font-family: var(--font-ui);
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.2s ease;
        }

        .dock-btn:hover { background: var(--border-dim); }

        .dock-btn.primary {
            background: var(--text-main);
            color: var(--bg-void);
        }
        .dock-btn.primary:hover { background: #d1d5db; }

        /* --- Overlays (Command Palette & Drawer) --- */
        .overlay-backdrop {
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.6);
            backdrop-filter: blur(4px);
            z-index: 90;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.2s ease;
        }
        .overlay-backdrop.active { opacity: 1; pointer-events: auto; }

        /* Command Palette */
        .cmd-palette {
            position: fixed;
            top: 20%;
            left: 50%;
            transform: translateX(-50%) scale(0.95);
            width: 90%;
            max-width: 600px;
            background: #0f0f11;
            border: 1px solid var(--border-highlight);
            border-radius: 16px;
            box-shadow: 0 40px 80px -20px rgba(0,0,0,0.8);
            z-index: 100;
            opacity: 0;
            pointer-events: none;
            transition: all 0.2s var(--ease-out-expo);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            max-height: 80vh;
        }

        .cmd-palette.active {
            transform: translateX(-50%) scale(1);
            opacity: 1;
            pointer-events: auto;
        }

        .cmd-input-wrapper {
            display: flex;
            align-items: center;
            padding: 16px 20px;
            border-bottom: 1px solid var(--border-dim);
            gap: 12px;
        }

        .cmd-input {
            background: transparent;
            border: none;
            color: var(--text-main);
            font-size: 16px;
            font-family: var(--font-ui);
            flex: 1;
            outline: none;
        }

        .cmd-results {
            padding: 8px;
            max-height: 300px;
            overflow-y: auto;
        }

        .cmd-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px 16px;
            border-radius: 8px;
            color: var(--text-muted);
            cursor: pointer;
            font-size: 14px;
        }
        
        .cmd-item:hover, .cmd-item.selected {
            background: var(--border-dim);
            color: var(--text-main);
        }
        
        .cmd-kbd {
            font-size: 10px;
            padding: 2px 6px;
            background: #27272a;
            border-radius: 4px;
        }

        /* Side Drawer */
        .drawer {
            position: fixed;
            top: 0;
            right: 0;
            bottom: 0;
            width: 400px;
            max-width: 100vw;
            background: #0f0f11;
            border-left: 1px solid var(--border-dim);
            z-index: 100;
            transform: translateX(100%);
            transition: transform 0.4s var(--ease-out-expo);
            padding: 40px;
            display: flex;
            flex-direction: column;
        }
        
        .drawer.active { transform: translateX(0); }

        .drawer-header {
            margin-bottom: 40px;
        }
        
        .drawer-title {
            font-family: var(--font-display);
            font-size: 32px;
            margin-bottom: 8px;
            background: linear-gradient(135deg, #fff, #a1a1aa);
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .drawer-content p {
            line-height: 1.8;
            color: var(--text-muted);
            margin-bottom: 24px;
            font-size: 15px;
        }

        .drawer-content a {
            color: var(--accent-primary);
            text-decoration: none;
            border-bottom: 1px solid rgba(139, 92, 246, 0.3);
            transition: border-color 0.2s;
        }
        .drawer-content a:hover { border-color: var(--accent-primary); }

        .drawer-close {
            position: absolute;
            top: 24px;
            right: 24px;
            background: transparent;
            border: none;
            color: var(--text-muted);
            cursor: pointer;
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Toast */
        .toast {
            position: fixed;
            bottom: 32px;
            left: 50%;
            transform: translateX(-50%) translateY(20px);
            background: var(--text-main);
            color: var(--bg-void);
            padding: 10px 24px;
            border-radius: 99px;
            font-weight: 600;
            font-size: 13px;
            opacity: 0;
            pointer-events: none;
            transition: all 0.3s var(--ease-out-expo);
            z-index: 200;
        }
        .toast.show { opacity: 1; transform: translateX(-50%) translateY(0); }

        @media (max-width: 640px) {
            .workspace { padding: 20px; }
            .sidebar { 
                position: fixed; 
                bottom: 0; 
                width: 100%; 
                height: 70px;
                flex-direction: row;
                border-right: none;
                border-top: 1px solid var(--border-dim);
                padding: 0 20px;
                justify-content: space-between;
                background: rgba(5,5,5,0.95);
            }
            .sidebar:hover { width: 100%; } 
            .brand { display: none; }
            .nav-menu { flex-direction: row; flex: 1; justify-content: space-around; }
            .nav-label, .shortcut-hint { display: none !important; }
            .dock { 
                bottom: 100px; /* moved up to clear bottom nav */
                width: auto;
                left: 50%;
                transform: translateX(-50%);
            }
            .drawer { width: 100%; right: 0; }
        }
    </style>
</head>
<body>

    <div class="bg-canvas">
        <div id="stars1" class="star-layer layer-1"></div>
        <div id="stars2" class="star-layer layer-2"></div>
        <div id="stars3" class="star-layer layer-3"></div>
    </div>
    <div class="grain"></div>

    <!-- Sidebar -->
    <nav class="sidebar">
        <div class="brand">
            <div class="brand-logo"></div>
            <span class="brand-name">Quote.Web</span>
        </div>
        <div class="nav-menu">
            <div class="nav-item active" onclick="closeDrawer()">
                <i data-lucide="layout-grid" class="nav-icon"></i>
                <span class="nav-label">Discover</span>
            </div>
            <div class="nav-item" onclick="toggleCommandPalette()">
                <i data-lucide="search" class="nav-icon"></i>
                <span class="nav-label">Search</span>
                <span class="shortcut-hint">Ctrl K</span>
            </div>
            <div class="nav-item" onclick="openDrawer('about')">
                <i data-lucide="info" class="nav-icon"></i>
                <span class="nav-label">About</span>
            </div>
            <div class="nav-item" onclick="openDrawer('contact')">
                <i data-lucide="mail" class="nav-icon"></i>
                <span class="nav-label">Contact</span>
            </div>
        </div>
    </nav>

    <!-- Main Workspace -->
    <main class="workspace">
        <!-- Reader View -->
        <article class="reader-container">
            <div class="quote-badge">Daily Inspiration</div>
            <h1 class="quote-display" id="quote-text">
                "The only way to do great work is to love what you do."
            </h1>
            <div class="author-block">
                <div class="author-line"></div>
                <span id="quote-author">Steve Jobs</span>
            </div>
        </article>

        <!-- Floating Dock -->
        <div class="dock">
            <button class="dock-btn" onclick="copyQuote()">
                <i data-lucide="copy" size="16"></i>
            </button>
            <button class="dock-btn" onclick="shareQuote()">
                <i data-lucide="share-2" size="16"></i>
            </button>
            <div style="width: 1px; height: 24px; background: var(--border-dim); margin: 0 4px;"></div>
            <button class="dock-btn primary" onclick="fetchNewQuote()">
                <span>Fresh Quote</span>
                <i data-lucide="arrow-right" size="16"></i>
            </button>
        </div>
    </main>

    <!-- Overlays -->
    <div class="overlay-backdrop" id="backdrop" onclick="closeAllOverlays()"></div>

    <!-- Command Palette -->
    <div class="cmd-palette" id="cmd-palette">
        <div class="cmd-input-wrapper">
            <i data-lucide="search" size="18" style="color: var(--text-muted)"></i>
            <input type="text" class="cmd-input" placeholder="Search functionality coming soon..." disabled>
            <span class="cmd-kbd">ESC</span>
        </div>
        <div class="cmd-results">
            <!-- Simulated Results -->
            <div class="cmd-item selected" onclick="fetchNewQuote(); closeAllOverlays()">
                <span>Fetch new random quote</span>
                <span class="cmd-kbd">Space</span>
            </div>
            <div class="cmd-item" onclick="openDrawer('about'); closeAllOverlays(true)">
                <span>Read about project</span>
            </div>
            <div class="cmd-item" onclick="copyQuote(); closeAllOverlays()">
                <span>Copy current quote</span>
                <span class="cmd-kbd">Ctrl C</span>
            </div>
        </div>
    </div>

    <!-- Side Drawer -->
    <aside class="drawer" id="side-drawer">
        <button class="drawer-close" onclick="closeDrawer()">
            <i data-lucide="x" size="24"></i>
        </button>
        <div class="drawer-content" id="drawer-body">
            <!-- Content Injected via JS -->
        </div>
    </aside>

    <div class="toast" id="toast">Copied to clipboard</div>

    <!-- Logic -->
    <script>
        // Init Icons
        lucide.createIcons();

        // --- Star Generation ---
        function generateStars(layerId, count, color, size) {
            const layer = document.getElementById(layerId);
            let boxShadow = '';
            for (let i = 0; i < count; i++) {
                const x = Math.floor(Math.random() * 100); // vw
                const y = Math.floor(Math.random() * 100); // vh
                boxShadow += `${x}vw ${y}vh 0 ${color}, `;
            }
            // Add a duplicate set for seamless scrolling (simple hack)
            for (let i = 0; i < count; i++) {
                const x = Math.floor(Math.random() * 100); 
                const y = Math.floor(Math.random() * 100) + 100; // Offset by 100vh
                boxShadow += `${x}vw ${y}vh 0 ${color}, `;
            }
            
            layer.style.boxShadow = boxShadow.slice(0, -2);
            layer.style.width = size;
            layer.style.height = size;
            layer.style.opacity = isMobile ? 0.6 : 0.8; // Lower opacity on mobile
        }

        // Generate 3 layers of stars (Optimized Counts)
        const isMobile = window.innerWidth < 768;
        const counts = isMobile 
            ? { l1: 20, l2: 10, l3: 4 }     // Mobile: ~34 stars (Clean & Minimal)
            : { l1: 400, l2: 150, l3: 40 }; // Desktop: ~590 stars

        generateStars('stars1', counts.l1, '#fff', '1px');       
        generateStars('stars2', counts.l2, '#eac7ff', '2px');    
        generateStars('stars3', counts.l3, '#fbcfe8', '3px');     

        // State
        const API_BASE = "https://quotes-api-ruddy.vercel.app";
        let allQuotes = []; // Cache for search
        let isFetchingAll = false;

        const ui = {
            text: document.getElementById('quote-text'),
            author: document.getElementById('quote-author'),
            backdrop: document.getElementById('backdrop'),
            palette: document.getElementById('cmd-palette'),
            drawer: document.getElementById('side-drawer'),
            drawerBody: document.getElementById('drawer-body'),
            toast: document.getElementById('toast'),
            cmdInput: document.querySelector('.cmd-input'),
            cmdResults: document.querySelector('.cmd-results')
        };

        const content = {
            about: `
                <div class="drawer-header"><h2 class="drawer-title">About</h2></div>
                <p>Quote.Web is a curated digital space designed to focus on the power of words. We removed the clutter to let the thoughts stand out.</p>
                <p>Powered by our custom <strong>Quotes API</strong>, utilized by developers worldwide to serve inspiration on demand.</p>
                <p>Version 2.0.0 — Redesigned for clarity.</p>
            `,
            contact: `
                <div class="drawer-header"><h2 class="drawer-title">Contact</h2></div>
                <p>Have a suggestion or found a bug? I'd love to hear from you.</p>
                <p>Email: <a href="mailto:maithilpatil9@gmail.com">maithilpatil9@gmail.com</a></p>
                <p>GitHub: <a href="https://github.com/Chronos778" target="_blank">Chronos778</a></p>
            `
        };

        // --- Core Quote Logic ---

        async function fetchNewQuote() {
            ui.text.classList.add('loading');
            
            try {
                // Fetch random from API
                const response = await fetch(`${API_BASE}/quotes/random`);
                const json = await response.json();
                renderQuote(json.data);
            } catch (error) {
                console.error("Failed to fetch", error);
                // Fallback attempt from local cache if available
                if (allQuotes.length > 0) {
                    const fallback = allQuotes[Math.floor(Math.random() * allQuotes.length)];
                    renderQuote(fallback);
                } else {
                    renderQuote({
                        text: "The only real failure in life is not to be true to the best one knows.",
                        author: "Buddha (Offline)"
                    });
                }
            }
        }

        function renderQuote(data) {
            // Min delay for animation smoothness
            setTimeout(() => {
                ui.text.innerText = `"${data.text}"`;
                ui.author.innerText = data.author || "Unknown";
                ui.text.classList.remove('loading');
            }, 300);
        }

        function copyQuote() {
            const textToCopy = ui.text.innerText + " — " + ui.author.innerText;
            navigator.clipboard.writeText(textToCopy);
            showToast();
        }

        function shareQuote() {
            if (navigator.share) {
                navigator.share({
                    title: 'Daily Inspiration',
                    text: ui.text.innerText + " — " + ui.author.innerText,
                    url: window.location.href
                }).catch(console.error);
            } else {
                copyQuote();
            }
        }

        function showToast() {
            ui.toast.classList.add('show');
            setTimeout(() => ui.toast.classList.remove('show'), 2000);
        }

        // --- Search / Command Palette Logic ---

        async function ensureQuotesLoaded() {
            if (allQuotes.length > 0 || isFetchingAll) return;
            isFetchingAll = true;
            ui.cmdInput.placeholder = "Loading 10,000+ quotes...";
            
            try {
                const response = await fetch(`${API_BASE}/quotes`);
                const json = await response.json();
                if (json.success && Array.isArray(json.data)) {
                    allQuotes = json.data;
                    ui.cmdInput.placeholder = "Search by keyword or author...";
                    ui.cmdInput.disabled = false;
                    ui.cmdInput.focus();
                }
            } catch (e) {
                console.error("Failed to load all quotes", e);
                ui.cmdInput.placeholder = "Failed to load search index.";
            } finally {
                isFetchingAll = false;
            }
        }

        function handleSearch(e) {
            const query = e.target.value.toLowerCase();
            if (query.length < 2) {
                renderSearchResults([]);
                return;
            }

            const results = allQuotes.filter(q => 
                q.text.toLowerCase().includes(query) || 
                (q.author && q.author.toLowerCase().includes(query))
            ).slice(0, 50); // Limit to 50 results for performance

            renderSearchResults(results);
        }

        function renderSearchResults(results) {
            ui.cmdResults.innerHTML = '';
            
            if (results.length === 0 && ui.cmdInput.value.length >= 2) {
                ui.cmdResults.innerHTML = '<div class="cmd-item" style="color: var(--text-muted)">No matches found.</div>';
                return;
            }

            // Default actions when empty
            if (results.length === 0) {
                 ui.cmdResults.innerHTML = `
                    <div class="cmd-item selected" onclick="fetchNewQuote(); closeAllOverlays()">
                        <span>Fetch new random quote</span>
                        <span class="cmd-kbd">Space</span>
                    </div>
                `;
                return;
            }

            // Render Results
            results.forEach(quote => {
                const div = document.createElement('div');
                div.className = 'cmd-item';
                div.innerHTML = `
                    <div style="display:flex; flex-direction:column; gap:4px; overflow:hidden;">
                        <span style="white-space:nowrap; overflow:hidden; text-overflow:ellipsis; color:var(--text-main);">${quote.text}</span>
                        <span style="font-size:11px; color:var(--text-faint);">${quote.author}</span>
                    </div>
                `;
                div.onclick = () => {
                    renderQuote(quote);
                    closeAllOverlays();
                };
                ui.cmdResults.appendChild(div);
            });
        }

        // --- UI State Management ---

        function toggleCommandPalette() {
            const isActive = ui.palette.classList.contains('active');
            if (isActive) {
                closeAllOverlays();
            } else {
                ui.backdrop.classList.add('active');
                ui.palette.classList.add('active');
                
                // Initialize Search
                if (allQuotes.length === 0) {
                    ui.cmdInput.disabled = true;
                    ensureQuotesLoaded();
                } else {
                    ui.cmdInput.disabled = false;
                    ui.cmdInput.focus();
                }
                
                // Reset results to default
                ui.cmdInput.value = '';
                renderSearchResults([]);
            }
        }

        function openDrawer(type) {
            closeAllOverlays(); 
            ui.drawerBody.innerHTML = content[type];
            ui.backdrop.classList.add('active');
            ui.drawer.classList.add('active');
        }

        function closeDrawer() {
            ui.drawer.classList.remove('active');
            ui.backdrop.classList.remove('active');
        }

        function closeAllOverlays(keepBackdrop = false) {
            ui.palette.classList.remove('active');
            ui.drawer.classList.remove('active');
            if (!keepBackdrop) ui.backdrop.classList.remove('active');
        }

        // --- Event Listeners ---

        document.addEventListener('keydown', (e) => {
            if ((e.ctrlKey || e.metaKey) && e.key === 'k') {
                e.preventDefault();
                toggleCommandPalette();
            }
            if (e.key === 'Escape') closeAllOverlays();
            if (e.code === 'Space' && !ui.palette.classList.contains('active')) {
                // e.preventDefault(); // Optional: prevent scroll
                // fetchNewQuote(); // Optional: Space to refresh
            }
        });

        ui.cmdInput.addEventListener('input', handleSearch);

        // Initialize
        fetchNewQuote();

    </script>
</body>
</html>